# üèóÔ∏è CloudChef Print Agent - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–í–µ—Ä—Å–∏—è:** 1.1.2
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** Electron Desktop Application
**–Ø–∑—ã–∫:** TypeScript (‚Üí –º–∏–≥—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ JavaScript)
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-09

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–û–±—â–∏–π –æ–±–∑–æ—Ä](#–æ–±—â–∏–π-–æ–±–∑–æ—Ä)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–ü—Ä–æ—Ü–µ—Å—Å—ã Electron](#–ø—Ä–æ—Ü–µ—Å—Å—ã-electron)
- [–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö](#–ø–æ—Ç–æ–∫–∏-–¥–∞–Ω–Ω—ã—Ö)
- [–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

---

## üéØ –û–±—â–∏–π –æ–±–∑–æ—Ä

CloudChef Print Agent - –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–µ—á–∞—Ç–∏ —ç—Ç–∏–∫–µ—Ç–æ–∫ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–∏—Ç–∞–Ω–∏—è. –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –º–æ—Å—Ç –º–µ–∂–¥—É –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º CloudChef –∏ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- üñ®Ô∏è **–ü–µ—á–∞—Ç—å —ç—Ç–∏–∫–µ—Ç–æ–∫** - –ø—Ä–∏–µ–º –∑–∞–¥–∞–Ω–∏–π –ø–æ WebSocket –∏ –ø–µ—á–∞—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–∏–Ω—Ç–µ—Ä
- üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - —Ç–æ–∫–µ–Ω-based –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- üîÑ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ GitHub
- üíæ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ electron-store
- üìä **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- üöÄ **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫** - –∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cloudchef-print-agent/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main/                    # Main Process (Electron)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.ts             # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ socket-manager.ts   # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ printer-manager.ts  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ preload/                 # Preload Scripts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ preload.ts          # –ú–æ—Å—Ç –º–µ–∂–¥—É main –∏ renderer
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ renderer/                # Renderer Process (UI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html          # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts            # React UI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ shared/                  # –û–±—â–∏–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ types.ts            # TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îÇ
‚îú‚îÄ‚îÄ assets/                      # –ò–∫–æ–Ω–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã
‚îú‚îÄ‚îÄ dist/                        # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ release/                     # Production builds (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ package.json                 # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ tsconfig.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TypeScript
‚îî‚îÄ‚îÄ electron.vite.config.ts     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
```

---

## üß© –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. **CloudChefPrintAgent** (main.ts)
–ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫–Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (BrowserWindow)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ tray icon –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç—Ä–µ–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ IPC —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç renderer –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è SocketManager –∏ PrinterManager
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —á–µ—Ä–µ–∑ electron-store

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```typescript
constructor()                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
setupAppHandlers()              // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Electron app handlers
createWindow()                  // –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞
createTray()                    // –°–æ–∑–¥–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –≤ —Ç—Ä–µ–µ
setupIpcHandlers()              // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IPC –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
setupAutoUpdater()              // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
onPrintJob(job: PrintJob)       // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ –ø–µ—á–∞—Ç—å
executePrint(job: PrintJob)     // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—á–∞—Ç–∏
```

**–°–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `mainWindow: BrowserWindow` - –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
- `tray: Tray` - –∏–∫–æ–Ω–∫–∞ –≤ —Ç—Ä–µ–µ
- `socketManager: SocketManager` - –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `printerManager: PrinterManager` - –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤
- `connectionStatus: ConnectionStatus` - —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `isQuiting: boolean` - —Ñ–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

### 2. **SocketManager** (socket-manager.ts)
–£–ø—Ä–∞–≤–ª—è–µ—Ç WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ —Å–µ—Ä–≤–µ—Ä—É CloudChef.

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–µ—á–∞—Ç–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ —Å —Ç–æ–∫–µ–Ω–æ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –Ω–∞ –ø–µ—á–∞—Ç—å
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–µ—á–∞—Ç–∏
- Heartbeat (–ø–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```typescript
connectToRestaurant(code: string)   // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É
disconnect()                        // –û—Ç–∫–ª—é—á–µ–Ω–∏–µ
setAgentToken(token: string)        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞
sendPrintResult(jobId, status, msg) // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

**–°–æ–±—ã—Ç–∏—è WebSocket:**
- `register_agent` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `agent_registered` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `print_command` - –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –ø–µ—á–∞—Ç—å
- `agent_heartbeat` - ping —Å–µ—Ä–≤–µ—Ä–∞
- `print_result` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—á–∞—Ç–∏

**–°–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `socket: Socket` - WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- `serverUrl: string` - URL —Å–µ—Ä–≤–µ—Ä–∞
- `restaurantCode: string` - –∫–æ–¥ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- `agentToken: string` - —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `reconnectAttempts: number` - –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `isRegistered: boolean` - —Ñ–ª–∞–≥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

---

### 3. **PrinterManager** (printer-manager.ts)
–£–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏ –∏ –ø–µ—á–∞—Ç—å—é —ç—Ç–∏–∫–µ—Ç–æ–∫.

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (thermal/inkjet/laser)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML —ç—Ç–∏–∫–µ—Ç–∫–∏ –∏–∑ –¥–∞–Ω–Ω—ã—Ö
- –ü–µ—á–∞—Ç—å —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (Windows/macOS/Linux)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```typescript
getPrinters()                         // –°–ø–∏—Å–æ–∫ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤
printLabel(printer, data, offsetX, offsetY) // –ü–µ—á–∞—Ç—å —ç—Ç–∏–∫–µ—Ç–∫–∏
generateLabelHTML(data)               // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML
```

**–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã:**
- **Windows**: PowerShell –∫–æ–º–∞–Ω–¥—ã
- **macOS**: `lpstat`, `lpr`
- **Linux**: CUPS –∫–æ–º–∞–Ω–¥—ã

**–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ö–µ—à –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –Ω–∞ 30 —Å–µ–∫—É–Ω–¥
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è

---

## ‚öôÔ∏è –ü—Ä–æ—Ü–µ—Å—Å—ã Electron

### Main Process
**–§–∞–π–ª:** `src/main/main.ts`

**–ó–∞–¥–∞—á–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–∞–º–∏
- –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ (–ø—Ä–∏–Ω—Ç–µ—Ä—ã, –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫)
- WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Node.js APIs (fs, path, child_process)
- Electron APIs (app, BrowserWindow, Tray, Menu, ipcMain)
- Socket.IO Client
- electron-store
- electron-log
- electron-updater
- auto-launch
- pdf-to-printer

---

### Renderer Process
**–§–∞–π–ª:** `src/renderer/index.ts`

**–ó–∞–¥–∞—á–∏:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ UI –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –≤ main process —á–µ—Ä–µ–∑ IPC

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- React (UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
- Radix UI (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- IPC –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å main process

---

### Preload Script
**–§–∞–π–ª:** `src/preload/preload.ts`

**–ó–∞–¥–∞—á–∏:**
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–æ—Å—Ç –º–µ–∂–¥—É main –∏ renderer
- –≠–∫—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ IPC API –≤ renderer —á–µ—Ä–µ–∑ `window.api`

**Exposed API:**
```typescript
window.api = {
  // Settings
  getSettings: () => Promise<AppSettings>
  saveSettings: (settings) => Promise<void>

  // Printers
  getPrinters: () => Promise<PrinterInfo[]>

  // Connection
  connect: (code) => Promise<void>
  disconnect: () => Promise<void>
  onConnectionStatus: (callback) => void

  // Updates
  checkForUpdates: () => Promise<void>
  onUpdateAvailable: (callback) => void
  onDownloadProgress: (callback) => void
  installUpdate: () => Promise<void>
}
```

---

## üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
```
User Input (–∫–æ–¥ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞)
  ‚Üí Renderer (IPC)
    ‚Üí Main Process
      ‚Üí SocketManager.connectToRestaurant()
        ‚Üí WebSocket.connect(serverUrl)
          ‚Üí emit('register_agent', { token, printerInfo })
            ‚Üê on('agent_registered')
              ‚Üí Update UI status
```

### 2. –ü–µ—á–∞—Ç—å —ç—Ç–∏–∫–µ—Ç–∫–∏
```
CloudChef Server
  ‚Üí WebSocket.emit('print_command', { jobId, labelData })
    ‚Üí SocketManager.onPrintJob()
      ‚Üí CloudChefPrintAgent.onPrintJob()
        ‚Üí Send to Renderer (IPC notification)
        ‚Üí PrinterManager.printLabel()
          ‚Üí Generate HTML
          ‚Üí Save to temp file
          ‚Üí Execute print command
            ‚Üí Send result back via WebSocket
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤
```
Renderer
  ‚Üí IPC: getPrinters
    ‚Üí Main Process
      ‚Üí PrinterManager.getPrinters()
        ‚Üí Execute system command (lpstat/PowerShell)
        ‚Üí Parse output
        ‚Üí Return list
      ‚Üê IPC response
    ‚Üê Update UI
```

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Production Dependencies
```json
{
  "@radix-ui/*": "UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫",
  "auto-launch": "–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã",
  "electron-log": "–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª",
  "electron-store": "–•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫",
  "electron-updater": "–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ GitHub",
  "pdf-to-printer": "–ü–µ—á–∞—Ç—å PDF –Ω–∞ Windows",
  "socket.io-client": "WebSocket –∫–ª–∏–µ–Ω—Ç"
}
```

### Dev Dependencies
```json
{
  "electron": "Electron framework",
  "electron-builder": "–°–±–æ—Ä–∫–∞ production –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
  "electron-vite": "Dev —Å–µ—Ä–≤–µ—Ä –∏ bundler",
  "typescript": "–¢–∏–ø–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞",
  "vite": "Bundler –¥–ª—è renderer –ø—Ä–æ—Ü–µ—Å—Å–∞",
  "webpack": "Bundler (—Å—Ç–∞—Ä—ã–π)",
  "concurrently": "–ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–∞–Ω–¥"
}
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
–§–æ—Ä–º–∞—Ç: `agent_<RESTAURANT_CODE>_<32-char-hex>`

–ü—Ä–∏–º–µ—Ä: `agent_ABCD1234_a1b2c3d4e5f6...`

**–•—Ä–∞–Ω–µ–Ω–∏–µ:**
- electron-store (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ –Ω–∞ –¥–∏—Å–∫–µ)
- –ü—É—Ç—å: `~/Library/Application Support/cloudchef-print-agent/config.json` (macOS)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞
- –í–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∫–∞–∂–¥—ã–π heartbeat
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∫–æ–¥ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –∏–∑ —Ç–æ–∫–µ–Ω–∞

---

## üöÄ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ó–∞–ø—É—Å–∫
1. `app.whenReady()` - Electron –≥–æ—Ç–æ–≤
2. –°–æ–∑–¥–∞–Ω–∏–µ `CloudChefPrintAgent` instance
3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `SocketManager` –∏ `PrinterManager`
4. –°–æ–∑–¥–∞–Ω–∏–µ window –∏ tray icon
5. –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ electron-store
6. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É (–µ—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–∫–µ–Ω)
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### –†–∞–±–æ—Ç–∞
1. –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –Ω–∞ –ø–µ—á–∞—Ç—å —á–µ—Ä–µ–∑ WebSocket
2. Heartbeat –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ IPC –∫–æ–º–∞–Ω–¥ –æ—Ç UI
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
1. `app.on('before-quit')` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
2. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
3. –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–æ–Ω
4. –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (electron-store)

```typescript
{
  serverUrl: 'https://cloudchef-print-server.onrender.com',
  restaurantCode: 'ABCD1234',
  agentToken: 'agent_ABCD1234_...',
  selectedPrinter: 'Zebra ZD420',
  labelOffsetHorizontal: 0,  // –º–º
  labelOffsetVertical: 0,    // –º–º
  autoLaunch: true,
  minimizeToTray: true,
  startMinimized: true,
  notifications: true,
  isFirstRun: false,
  windowBounds: { width: 800, height: 600, x: 100, y: 100 }
}
```

---

## üêõ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞:** electron-log

**–£—Ä–æ–≤–Ω–∏:**
- `log.info()` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `log.warn()` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `log.error()` - –æ—à–∏–±–∫–∏

**–ü—É—Ç–∏ –ª–æ–≥–æ–≤:**
- macOS: `~/Library/Logs/cloudchef-print-agent/main.log`
- Windows: `%USERPROFILE%\AppData\Roaming\cloudchef-print-agent\logs\main.log`
- Linux: `~/.config/cloudchef-print-agent/logs/main.log`

**–†–æ—Ç–∞—Ü–∏—è:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 5MB
- –•—Ä–∞–Ω–∏—Ç—Å—è: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Ñ–∞–π–ª–æ–≤

---

## üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä:** GitHub Releases

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
2. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞
3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –¥–æ—Å—Ç—É–ø–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ —Ñ–æ–Ω–µ
5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ

**–°–æ–±—ã—Ç–∏—è:**
- `update-available` - –¥–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `download-progress` - –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
- `update-downloaded` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
- `update-not-available` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–µ—Ç

---

## üé® UI –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –í–∫–ª–∞–¥–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫:
1. **Connection** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É, –∫–æ–¥ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
2. **Printer** - –≤—ã–±–æ—Ä –ø—Ä–∏–Ω—Ç–µ—Ä–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–º–µ—â–µ–Ω–∏—è
3. **General** - –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
4. **Updates** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
5. **Logs** - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- Radix UI Dialog, Select, Switch, Separator
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Tailwind CSS —Å—Ç–∏–ª–∏

---

## üîå IPC API

### Main ‚Üí Renderer
```typescript
mainWindow.webContents.send('connection-status', status)
mainWindow.webContents.send('print-job-received', job)
mainWindow.webContents.send('update-available')
mainWindow.webContents.send('download-progress', progress)
mainWindow.webContents.send('update-downloaded')
```

### Renderer ‚Üí Main
```typescript
ipcRenderer.invoke('get-settings')
ipcRenderer.invoke('save-settings', settings)
ipcRenderer.invoke('get-printers')
ipcRenderer.invoke('connect-to-restaurant', code)
ipcRenderer.invoke('disconnect-from-server')
ipcRenderer.invoke('check-for-updates')
ipcRenderer.invoke('install-update')
ipcRenderer.invoke('open-logs')
ipcRenderer.invoke('quit-app')
```

---

## üìù –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (types.ts)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:
- `LabelData` - –¥–∞–Ω–Ω—ã–µ —ç—Ç–∏–∫–µ—Ç–∫–∏
- `PrinterInfo` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–Ω—Ç–µ—Ä–µ
- `PrintResult` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—á–∞—Ç–∏
- `PrintJob` - –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –ø–µ—á–∞—Ç—å
- `ConnectionStatus` - —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `AppSettings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `WebSocketEvents` - —Å–æ–±—ã—Ç–∏—è WebSocket

---

## üõ†Ô∏è –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### macOS Dev Mode Issue
**–ü—Ä–æ–±–ª–µ–º–∞:** `require('electron')` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç string –≤–º–µ—Å—Ç–æ API –≤ dev —Ä–µ–∂–∏–º–µ

**–ü—Ä–∏—á–∏–Ω–∞:** TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è ‚Üí Node.js context ‚Üí Electron –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:** –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ —á–∏—Å—Ç—ã–π JavaScript (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)

---

## üöÄ Roadmap –º–∏–≥—Ä–∞—Ü–∏–∏ TypeScript ‚Üí JavaScript

### –≠—Ç–∞–ø—ã:
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
2. üîÑ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ `.ts` ‚Üí `.js`
3. üîÑ –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤
4. üîÑ –ó–∞–º–µ–Ω–∞ `import` –Ω–∞ `require`
5. üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ package.json
6. üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ dev —Ä–µ–∂–∏–º–∞

**–¶–µ–ª—å:** –†–∞–±–æ—Ç–∞—é—â–∏–π dev —Ä–µ–∂–∏–º –Ω–∞ macOS –±–µ–∑ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ TypeScript

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-01-09
**–ê–≤—Ç–æ—Ä:** CloudChef Team
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
